open Char
open Lwt
open Lwt_react
open LTerm_widget

(* [in_frame w] is w wrapped in a frame *)
let in_frame w = let f = new frame in f#set w; f 
let in_modal w = let f = new modal_frame in f#set w; f 

let ship_ascii = "\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\149\166\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\164\226\149\144-\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\149\145&]\194\160\194\160\194\160\194\160\194\160\194\160]\194\160\194\160\194\160\194\172\226\137\136\226\137\136\226\137\136\226\137\136\226\149\166\194\160\194\160\194\160\226\140\144-\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\150\144 $&\226\150\144%;\226\150\132..\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160`````\194\160\194\160\194\160}\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\150\144 *\226\150\132\226\140\144;'#.\194\160\194\160\194\160\194\160-\194\160\194\160'\194\160\194\160\194\160/\194\160-\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\149\153\226\150\132\226\150\132\194\160,==\194\160,\226\149\148\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144-\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160,.\194\160\226\140\144\226\149\144\194\160'`\194\160\194\160\194\160\194\160\\\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160/\194\160'\194\160,~\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160,-**'\\\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160.......................\194\160\194\160\194\160\194\160\194\160\194\160\194\160`--~.......\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\226\149\145\194\160\194\160\194\160\194\160\194\160\194\160\194\160`-\194\160.-\194\160'\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160.\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160'''''`'\194\160.\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\226\149\145\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\148\130\194\160\194\160\194\160\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160,,, ---- ------\194\160- -\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160*\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\226\149\154\226\149\144\226\149\144\226\149\151\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\148\130\194\160\194\160\194\160\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\150\144\226\149\154\226\149\160\226\149\159\226\149\160\226\150\144\194\160\194\160:\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\226\149\144\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\226\149\148\226\149\144\226\149\144\226\149\157\194\160\194\160\194\160\194\160\194\160\194\160\194\160!\194\160\194\160\194\160\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\150\144\226\149\160\226\149\160\226\149\159\226\149\159\226\150\144\194\160\194\160:\194\160\194\160\194\160 \194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\226\149\144\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\226\149\145\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\148\130\194\160\194\160\194\160\194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160```~\194\160.....  ..\194\160\194\160...\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160 ^\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\226\149\145 \194\160\194\160\194\160\194\160\194\160\194\160-`\194\160\194\160`. \194\160\194\160\226\140\161\194\160\226\140\161\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160 .\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160...---- '\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160'**\226\140\144,/\194\160\194\160\194\160\194\160\194\160\194\160\194\160'......................'\194\160\194\160\194\160\194\160\194\160\194\160\194\160.\226\148\128\194\160`''''''''\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160''\194\160...z\226\137\164\194\172.\194\160\194\160\194\160/\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\\  .\194\160`\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\149\159%]\226\140\144\194\160\194\160\194\160\194\160 \226\149\154\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144-\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\150\144 #\226\149\148\226\150\144\226\149\153`\226\149\154\194\160\194\160\194\160\194\160\194\160#\194\160\194\160\226\137\136==\194\160-\194\160\194\160,\194\160.\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\150\144 #\226\149\153\226\150\140--\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160----\194\172\194\160\194\160\194\160\226\149\152\194\160`\194\160}\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\149\159\226\150\146#\194\160\194\160\226\149\146\194\160\194\160\194\160\226\149\146\194\160\194\160\194\160\194\160``'`'\194\160\194\160\194\160\194\160/\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144\226\149\144``\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\194\160\n";;

let get_components exit ship () =
  let mainbox = new hbox in

  let vbox = new vbox in 

  let mapbox = new hbox in
  let map = new button ("JUMP") in
  mapbox#add (new spacing ~cols:40 ());
  mapbox#add (in_frame map);
  mapbox#add (new spacing ~cols:40 ());

  let footer = new hbox in

  (* Generating weapons section *)
  let weapons_section = new vbox in 
  let weapons_label = new label "Weapons" in
  let weapons = new hbox in
  for i = 0 to 3 do
    match (Ship.get_weapon ship i) with
    | Some w ->
      let some = new label "Weapon" in
      weapons#add some;
      if i<>3 then weapons#add new vline
      else () 
    | None -> 
      let none = new label "None" in
      weapons#add none;
      if i<>3 then weapons#add new vline
      else () 
  done;
  
  (* Generating Systems section *)
  let systems_section = new vbox in 
  let systems_label = new label "Systems" in
  let systems = new hbox in 
  
  let engine_system = new vbox in
  let engine_lbl = new label "Engine" in 
  systems#add engine_system;
  systems#add ~expand:false new vline;

  let shield_system = new vbox in 
  let shield_lbl = new label "Shield" in
  systems#add shield_system;
  
  let weapons_system = new vbox in 
  let weapons_lbl = new label "Weapons" in
  systems#add weapons_system;
  

  weapons_section#add ~expand:false new hline;
  weapons_section#add weapons_label;
  weapons_section#add ~expand:false new hline;
  weapons_section#add weapons;
  
  systems_section#add ~expand:false new hline;
  systems_section#add systems_label;
  systems_section#add ~expand:false new hline;
  
  footer#add weapons_section;


  let vbox2 = new vbox in
  let ship_ascii = new label ship_ascii in
  vbox2#add ~expand:false mapbox;
  vbox2#add ship_ascii;
  vbox2#add ~expand:false footer;

  mainbox#add ~expand:false vbox;
  mainbox#add vbox2;
  (map, mainbox);
